{
    "openapi": "3.0.1",
    "info": {
        "title": "Film API",
        "description": "An API for the Film library service",
        "version": "1.0"
    },
    "components": {
        "schemas": {
            "film": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "title": {
                        "type": "string"
                    },
                    "owner": {
                        "type": "integer"
                    },
                    "private": {
                        "type": "boolean"
                    },
                    "watchDate": {
                        "type": "string",
                        "format": "date"
                    },
                    "rating": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 10
                    },
                    "favorite": {
                        "type": "boolean"
                    }
                },
                "required": [
                    "id",
                    "title",
                    "owner",
                    "private"
                ]
            },
            "films": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/film"
                }
            },
            "review": {
                "type": "object",
                "properties": {
                    "filmId": {
                        "type": "integer"
                    },
                    "reviewerId": {
                        "type": "integer"
                    },
                    "completed": {
                        "type": "boolean",
                        "default": "false"
                    },
                    "reviewDate": {
                        "type": "string",
                        "format": "date"
                    },
                    "rating": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 10
                    },
                    "review": {
                        "type": "string",
                        "maxLength": 1000
                    }
                },
                "required": [
                    "filmId",
                    "reviewerId",
                    "completed"
                ]
            },
            "reviews": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/review"
                }
            },
            "user": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "name": {
                        "type": "string"
                    },
                    "email": {
                        "type": "string",
                        "format": "email"
                    },
                    "password": {
                        "type": "string",
                        "format": "password"
                    }
                },
                "required": [
                    "id",
                    "email",
                    "password"
                ]
            },
            "logReq":{
                "type":"object",
                "properties":{
                    "username": "string",
                    "password": "string"
                }
            }
        },
        "securitySchemes":{
            "cookieAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "SESSIONID"
            }
        }
    },
    "paths": {
        "/login":{
            "post":{
                "summary":"Log in with cookie",
                "requestBody":{
                    "required":"true",
                    "description":"A JSON obj",
                    "content":{
                        "application/json":{
                            "schema":{
                                "$ref":"#/components/schemas/logReq"
                            }
                        }
                    }
                },
                "responses":{
                    "200":{
                        "description":"Logged in",
                        "headers":{
                            "Set-Cookie":{
                                "schema":{
                                    "type":"string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/films/public": {
            "get": {
                "tags": [
                    "films"
                ],
                "description": "Get the list of public films",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/films"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "films"
                ],
                "description": "Create a film",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/film"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/film"
                                }
                            }
                        },
                        "headers": {
                            "Location": {
                                "schema": {
                                    "type": "string",
                                    "format": "uri"
                                },
                                "description": "The URI of the new resource just created"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string",
                                    "description": "The reason for the bad request"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/film/public/{id}": {
            "get": {
                "tags": [
                    "film"
                ],
                "description": "Search a single film",
                "parameters": [
                    {
                    "name": "id",
                    "schema": {
                        "type": "integer"
                    },
                    "in": "path",
                    "required": true
                }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/film"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/reviews/{filmId}": {
            "parameters": [
                {
                    "name": "filmId",
                    "schema": {
                        "type": "integer"
                    },
                    "in": "path",
                    "required": true
                }
            ],
            "get": {
                "tags": [
                    "reviews"
                ],
                "description": "Get the reviews of a public film",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/reviews"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            } 
    
        },
        "/review/{id}/{filmId}":{
            "parameters":[
                {
                    "name":"id",
                    "schema":{
                        "type":"integer"
                    },
                    "in":"path",
                    "required":true
                },
                {
                    "name":"filmId",
                    "schema":{
                        "type":"integer"
                    },
                    "in":"path",
                    "required":true
                }
            ],
            "get":{
                "tags":["review"],
                "description":"Get a review",
                "responses":{
                    "200":{
                        "description":"A film review",
                        "content":{
                            "application/json":{
                                "schema":{
                                    "$ref":"#/components/schemas/review"
                                }
                            }
                        }
                    }
                }
            },








            "put": {
                "tags": [
                    "item"
                ],
                "description": "Update an item",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/item"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string",
                                    "description": "The reason for the bad request"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "delete": {
                "tags": [
                    "item"
                ],
                "description": "Delete an item",
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            }

        },
        "/biblio/items/{id}/citing": {
            "parameters": [
                {
                    "name": "id",
                    "schema": {
                        "type": "integer"
                    },
                    "in": "path",
                    "required": true
                }
            ],
            "get": {
                "tags": [
                    "citing"
                ],
                "description": "read the citing items",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/items"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "post": {
                "tags": [
                    "citing"
                ],
                "description": "Add a citing item",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/item"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "No Content"
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string",
                                    "description": "The reason for the bad request"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            }
        },
        "/biblio/items/{id}/cited": {
            "parameters": [
                {
                    "name": "id",
                    "schema": {
                        "type": "integer"
                    },
                    "in": "path",
                    "required": true
                }
            ],
            "get": {
                "tags": [
                    "cited"
                ],
                "description": "read the cited items",
                "parameters": [],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/items"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "post": {
                "tags": [
                    "cited"
                ],
                "description": "Add a citing item",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/item"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "No Content"
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "text/plain": {
                                "schema": {
                                    "type": "string",
                                    "description": "The reason for the bad request"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            }
        }
    }
}